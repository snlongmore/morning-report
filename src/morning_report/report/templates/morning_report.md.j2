# Morning Report — {{ day_name }}, {{ date }}

*Generated at {{ generated_at }}*

---

{% if data.get('calendar') and data.calendar.status == 'ok' %}
## Today's Schedule

{% if data.calendar.today %}
| Time | Event | Calendar | Location |
|------|-------|----------|----------|
{% for evt in data.calendar.today %}
{% if evt.all_day %}| All day | **{{ evt.title }}** | {{ evt.calendar }} | {{ evt.location or '—' }} |
{% else %}| {{ evt.start[11:16] }}–{{ evt.end[11:16] }} | **{{ evt.title }}** | {{ evt.calendar }} | {{ evt.location or '—' }} |
{% endif %}
{% endfor %}
{% else %}
No events scheduled for today.
{% endif %}

{% if data.calendar.upcoming %}
### Upcoming (to {{ data.calendar.date_range.to }})

{% for evt in data.calendar.upcoming %}
{% if evt.all_day %}- **{{ evt.title }}** — {{ evt.start[:10] }} all day ({{ evt.calendar }})
{% else %}- **{{ evt.title }}** — {{ evt.start[:10] }} {{ evt.start[11:16] }}–{{ evt.end[11:16] }} ({{ evt.calendar }})
{% endif %}
{% if evt.location %}  *{{ evt.location }}*
{% endif %}
{% endfor %}
{% endif %}

{% elif data.get('calendar') and data.calendar.status == 'error' %}
## Today's Schedule

> Calendar gatherer failed: {{ data.calendar.error }}

{% endif %}
---

{% if data.get('email') and data.email.status == 'ok' %}
## Email Summary

**{{ data.email.total_unread }} unread** across {{ data.email.account_summary | length }} accounts

{% for account, count in data.email.account_summary.items() %}
- **{{ account }}**: {{ count }} unread
{% endfor %}

{% if data.email.needs_response %}
### Needs Response

{% for msg in data.email.needs_response %}
- {% if msg._is_vip %}**[VIP]** {% endif %}**{{ msg.subject }}** — from {{ msg.sender }} ({{ msg.account }})
{% endfor %}
{% endif %}

{% elif data.get('email') and data.email.status == 'error' %}
## Email Summary

> Email gatherer failed: {{ data.email.error }}

{% endif %}
---

{% if data.get('github') and data.github.status == 'ok' %}
## GitHub

{% if data.github.notification_count %}
**{{ data.github.notification_count }}** unread notifications
{% endif %}

{% if data.github.prs_to_review %}
### PRs Needing Review

{% for pr in data.github.prs_to_review %}
- [**{{ pr.title }}**]({{ pr.url }}) — {{ pr.repository.nameWithOwner if pr.repository else '' }}
{% endfor %}
{% endif %}

{% if data.github.assigned_issues %}
### Assigned Issues

{% for issue in data.github.assigned_issues %}
- [**{{ issue.title }}**]({{ issue.url }}) — {{ issue.repository.nameWithOwner if issue.repository else '' }}
{% endfor %}
{% endif %}

{% if not data.github.notification_count and not data.github.prs_to_review and not data.github.assigned_issues %}
No GitHub activity.
{% endif %}

{% elif data.get('github') and data.github.status == 'error' %}
## GitHub

> GitHub gatherer failed: {{ data.github.error }}

{% endif %}
---

{% if data.get('arxiv') and data.arxiv.status == 'ok' %}
## arXiv Briefing

**{{ data.arxiv.total_new }}** new papers across {{ data.arxiv.categories_searched | join(', ') }}

{% if data.arxiv.tiers['1'] %}
### Tier 1 — Cites Your Work

{% for p in data.arxiv.tiers['1'] %}
- **{{ p.title }}** — {{ p.authors[:3] | join(', ') }}{% if p.author_count > 3 %} +{{ p.author_count - 3 }}{% endif %}
  [{{ p.arxiv_id }}]({{ p.abs_url }}) | {{ p.primary_category }}
{% endfor %}
{% endif %}

{% if data.arxiv.tiers['2'] %}
### Tier 2 — Core Research

{% for p in data.arxiv.tiers['2'] %}
- **{{ p.title }}** — {{ p.authors[:3] | join(', ') }}{% if p.author_count > 3 %} +{{ p.author_count - 3 }}{% endif %}
  [{{ p.arxiv_id }}]({{ p.abs_url }}) | {{ p.primary_category }} | Keywords: {{ p.matched_keywords | join(', ') }}
{% endfor %}
{% endif %}

{% if data.arxiv.tiers['3'] %}
### Tier 3 — COOL Project

{% for p in data.arxiv.tiers['3'] %}
- **{{ p.title }}** — {{ p.authors[:3] | join(', ') }}{% if p.author_count > 3 %} +{{ p.author_count - 3 }}{% endif %}
  [{{ p.arxiv_id }}]({{ p.abs_url }}) | {{ p.primary_category }} | Keywords: {{ p.matched_keywords | join(', ') }}
{% endfor %}
{% endif %}

{% if not data.arxiv.tiers['1'] and not data.arxiv.tiers['2'] and not data.arxiv.tiers['3'] %}
No papers matched your research interests today.
{% endif %}

{% if data.arxiv.pdfs_downloaded %}
*{{ data.arxiv.pdfs_downloaded }} PDFs downloaded to papers/*
{% endif %}
{% if not data.arxiv.ads_citations_available %}
*Note: ADS citation checking unavailable (no API token). Tier 1 classification disabled.*
{% endif %}

{% elif data.get('arxiv') and data.arxiv.status == 'error' %}
## arXiv Briefing

> arXiv gatherer failed: {{ data.arxiv.error }}

{% endif %}
---

{% if data.get('markets') and data.markets.status == 'ok' %}
## Markets

{% if data.markets.crypto %}
### Crypto

| Token | Price (USD) | 24h Change |
|-------|-------------|------------|
{% for id, info in data.markets.crypto.items() %}
{% if info.price_usd is defined %}| **{{ id }}** | ${{ "%.2f" | format(info.price_usd) if info.price_usd >= 1 else "%.6f" | format(info.price_usd) }} | {{ "%.1f" | format(info.change_24h_pct) }}% |
{% else %}| **{{ id }}** | {{ info.error }} | — |
{% endif %}
{% endfor %}
{% endif %}

{% if data.markets.stocks %}
### Indices & Funds

| Ticker | Price | Change |
|--------|-------|--------|
{% for ticker, info in data.markets.stocks.items() %}
{% if info.price is defined %}| **{{ ticker }}** | {{ "%.2f" | format(info.price) }} {{ info.currency }} | {{ "%.1f" | format(info.change_pct) if info.change_pct is not none else '—' }}% |
{% else %}| **{{ ticker }}** | {{ info.error }} | — |
{% endif %}
{% endfor %}
{% endif %}

{% if data.markets.stocks_error %}
> Stocks/indices unavailable: {{ data.markets.stocks_error }}
{% endif %}

{% elif data.get('markets') and data.markets.status == 'error' %}
## Markets

> Markets gatherer failed: {{ data.markets.error }}

{% endif %}
---

{% if data.get('ads') and data.ads.status == 'ok' %}
## Academic Metrics (ADS)

**{{ data.ads.author }}** — {{ data.ads.num_bibcodes }} papers in ADS

| Metric | Value |
|--------|-------|
| h-index | {{ data.ads.indicators.h }} |
| g-index | {{ data.ads.indicators.g }} |
| m-index | {{ data.ads.indicators.m }} |
| i10-index | {{ data.ads.indicators.i10 }} |
| i100-index | {{ data.ads.indicators.i100 }} |
| tori | {{ data.ads.indicators.tori }} |
| read10 | {{ data.ads.indicators.read10 }} |

**Citations:** {{ data.ads.citation_stats.total_citations }} total ({{ data.ads.citation_stats.citing_papers }} citing papers, {{ data.ads.citation_stats.self_citations }} self-citations)
**Reads:** {{ data.ads.basic_stats.total_reads }} total ({{ data.ads.basic_stats.recent_reads }} recent)

{% if data.ads.deltas and data.ads.deltas.get('indicators') %}
### Changes since {{ data.ads.deltas.compared_to }}

{% for key, val in data.ads.deltas.indicators.items() %}
- **{{ key }}**: {{ val.previous }} → {{ val.current }} ({{ '+' if val.delta > 0 else '' }}{{ val.delta }})
{% endfor %}
{% endif %}
{% if data.ads.deltas and data.ads.deltas.get('citations') %}
{% for key, val in data.ads.deltas.citations.items() %}
- **{{ key }}**: {{ val.previous }} → {{ val.current }} ({{ '+' if val.delta > 0 else '' }}{{ val.delta }})
{% endfor %}
{% endif %}

{% elif data.get('ads') and data.ads.status == 'skipped' %}
## Academic Metrics (ADS)

> ADS gatherer skipped: {{ data.ads.reason }}
> Set ADS_API_TOKEN or add api_token to config/config.yaml.

{% elif data.get('ads') and data.ads.status == 'error' %}
## Academic Metrics (ADS)

> ADS gatherer failed: {{ data.ads.error }}

{% endif %}
---

{% if data.get('news') and data.news.status == 'ok' %}
## News Digest

{% for category, articles in data.news.categories.items() %}
{% if articles %}
### {{ category }}

{% for article in articles %}
- [{{ article.title }}]({{ article.link }}) — *{{ article.source }}*
{% endfor %}
{% endif %}
{% endfor %}

{% elif data.get('news') and data.news.status == 'error' %}
## News Digest

> News gatherer failed: {{ data.news.error }}

{% endif %}
---

{% if data.get('weather') and data.weather.status == 'ok' %}
## Weather

{% for location, info in data.weather.locations.items() %}
### {{ location }}

{% if info.current is defined %}
**{{ info.current.description | capitalize }}** — {{ info.current.temp }}C (feels like {{ info.current.feels_like }}C), humidity {{ info.current.humidity }}%, wind {{ info.current.wind_speed }} m/s
{% endif %}

{% if info.forecast is defined %}
| Time | Forecast | Temp |
|------|----------|------|
{% for f in info.forecast %}
| {{ f.time[11:16] if f.time|length > 11 else f.time }} | {{ f.description }} | {{ f.temp }}C |
{% endfor %}
{% endif %}

{% if info.error is defined %}
> Weather unavailable: {{ info.error }}
{% endif %}
{% endfor %}

{% elif data.get('weather') and data.weather.status == 'skipped' %}
## Weather

> Weather gatherer skipped: {{ data.weather.reason }}
> Set OPENWEATHER_API_KEY or add api_key to config/config.yaml.

{% elif data.get('weather') and data.weather.status == 'error' %}
## Weather

> Weather gatherer failed: {{ data.weather.error }}

{% endif %}
---

*End of morning report.*
